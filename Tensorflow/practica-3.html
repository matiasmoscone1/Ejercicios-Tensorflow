<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"></script>
    <title>Document</title>
</head>
<body>
    
    <script>
    /* 
    
    /*Regresión lineal simple

    Objetivo:
    Entrenar un modelo que aprenda la función lineal:

        y = 2x+1

    Indicaciones:

        Crea un modelo secuencial.

        Agrega una sola capa densa con units: 1 y inputShape: [1].

    Compila el modelo con:

        optimizer: 'sgd'
        loss: 'meanSquaredError'

    Entrena el modelo con valores:

        const xs = tf.tensor2d([1, 2, 3, 4], [4, 1]);
        const ys = tf.tensor2d([3, 5, 7, 9], [4, 1]);
    
        Una vez entrenado, haz una predicción para x = 5.
    El resultado debería acercarse a 11.

*/

        /* EJERCICIO BONUS */

        const predictFunction = async () => {
            const model = tf.sequential();

            //capa 1
            model.add(tf.layers.dense({units: 1, inputShape: [1]}));

            model.compile({
                optimizer: "sgd",
                loss: "meanSquaredError"
            });

            const xs = tf.tensor2d([1, 2, 3, 4], [4, 1]);
            const ys = tf.tensor2d([3, 5, 7, 9], [4, 1]);


            await model.fit(xs, ys, {
                batchSize: 4,
                epochs: 300,
                callbacks: {
                    onEpochEnd: (epoch, logs) => {
                        console.log(`Epoca: ${epoch + 1}: - Perdida: ${logs.loss}`);
                    }
                }
            });

            tf.tidy(() => {
                const output = model.predict(tf.tensor2d([5], [1, 1]));

                //output.print();

                output.array().then((num) => {
                console.log(num[0][0]);
            });
            })

            //para saber cuantos parametros hay en cada capa
            //model.summary();

        }

        //predictFunction();


        //para saber que backend esta usando tensorflow: (cpu o webgl o wasm)
        //console.log(tf.getBackend());
        






    </script>


</body>
</html>